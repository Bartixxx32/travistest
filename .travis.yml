sudo: required
dist: trusty
language: bash
jobs:
  include:
    - stage: ob1
      script: 
- wget http://oxygenos.oneplus.net.s3.amazonaws.com/OnePlus5TOxygen_43_OTA_004_all_1801031407_e2352bc7493e4d48.zip -O one.zip
- unzip one.zip
- sudo rm -r one.zip
- wget https://raw.githubusercontent.com/xpirt/sdat2img/master/sdat2img.py
- chmod +x *
- ./sdat2img.py system.transfer.list  system.new.dat
- mkdir output
- sudo mount -t ext4 -o loop system.img output/
- sudo rm -r system.new.dat
- mkdir zip
- cd output
- sudo mv * ../zip
- cd ..
- cd zip
- sudo rm -r app/Chrome/Chrome.apk
- cd app/Chrome
- sudo touch "removed +100mb.txt"
- cd ../..
- sudo zip -r ob1.zip -s 1000m *
- echo .
- echo .
- echo .
- echo .
- echo .
- curl --upload-file ./ob1.zip https://transfer.sh/ob1.zip
- curl --upload-file ./ob1.z01 https://transfer.sh/ob1.z01
- echo .
- echo .
- echo .
- echo .
- echo .
- echo done
    - stage: ob2
      script:
- wget http://oxygenos.oneplus.net.s3.amazonaws.com/OnePlus5TOxygen_43_OTA_005_all_1801141242_0c19acb91a7d402d.zip -O one.zip
- unzip one.zip
- sudo rm -r one.zip
- wget https://raw.githubusercontent.com/xpirt/sdat2img/master/sdat2img.py
- chmod +x *
- ./sdat2img.py system.transfer.list  system.new.dat
- mkdir output
- sudo mount -t ext4 -o loop system.img output/
- sudo rm -r system.new.dat
- mkdir zip
- cd output
- sudo mv * ../zip
- cd ..
- cd zip
- sudo rm -r app/Chrome/Chrome.apk
- cd app/Chrome
- sudo touch "removed +100mb.txt"
- cd ../..
- sudo zip -r ob2.zip -s 1000m *
- echo .
- echo .
- echo .
- echo .
- echo .
- curl --upload-file ./ob2.zip https://transfer.sh/ob2.zip
- curl --upload-file ./ob2.z01 https://transfer.sh/ob2.z01
- echo .
- echo .
- echo .
- echo .
- echo .
- echo done

      
addons:
  apt:
    packages:
    - zip
    - unzip
    - ncftp
    - p7zip-full
    

notifications:
  webhooks: https://fathomless-fjord-24024.herokuapp.com/notify
